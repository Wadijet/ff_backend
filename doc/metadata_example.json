{
    "versionInfo": {
        "description": "Hệ thống Data Warehouse dùng MongoDB để trích xuất, làm sạch, chuẩn hóa và lưu trữ dữ liệu từ nhiều nguồn khác nhau.",
        "version": "1.2",
        "lastUpdated": "2025-02-05",
        "author": "Dao Manh Dung"
    },
    "databases": [
    {
        "name": "ff_auth",
        "type": "MongoDB",
        "connectionDetails": {
        "host": "localhost",
        "port": 27017,
        "database": "dwh_mongo",
        "username": "username",
        "password": "password",
        "replicaSet": "rs0",
        "connectionURI": "mongodb://username:password@localhost:27017/dwh_mongo"
        }
    },
    {
        "name": "log_db",
        "type": "MongoDB",
        "connectionDetails": {
        "host": "localhost",
        "port": 27017,
        "database": "analytics_db",
        "username": "username",
        "password": "password",
        "replicaSet": "rs1",
        "connectionURI": "mongodb://username:password@localhost:27017/analytics_db"
        }
    }
    ],
    "dataSources": [
    {
        "name": "CRM_System",
        "type": "SQL",
        "connectionDetails": {
        "host": "crm.database.local",
        "port": 5432,
        "database": "crm_db",
        "username": "dwh_user",
        "authentication": "OAuth2"
        }
    },
    {
        "name": "Ecommerce_API",
        "type": "API",
        "connectionDetails": {
        "baseURL": "https://api.ecommerce.com/v1",
        "apiKey": "API_KEY_123456",
        "authentication": "Bearer"
        }
    }
    ],
    "ETL_Pipelines": [
    {
        "name": "OrderDataPipeline",
        "description": "Pipeline xử lý dữ liệu đơn hàng từ API thương mại điện tử với phân trang.",
        "extract": {
        "source": "Ecommerce_API",
        "endpoint": "/orders",
        "method": "GET",
        "params": {
            "status": "completed",
            "date_from": "{{last_run_date}}"
        },
        "pagination": {
            "type": "cursor",
            "cursorField": "next_page_token",
            "initialValue": null,
            "limitParam": "limit",
            "limitValue": 100,
            "pageParam": "page",
            "startPage": 1,
            "maxPages": 50
        }
        },
        "transform": [
        { "step": "convert_currency", "description": "Chuẩn hóa tiền tệ về USD." },
        { "step": "filter_invalid_data", "description": "Loại bỏ đơn hàng không hợp lệ." }
        ],
        "load": {
        "targetDatabases": ["dwh_mongo", "analytics_db"],
        "targetCollection": "orders",
        "mode": "insert",
        "primaryKey": "order_id"
        },
        "schedule": "0 3 * * *"
    }
    ],
    "collections": [
    {
        "databases": ["dwh_mongo", "analytics_db"],
        "name": "orders",
        "description": "Collection lưu trữ dữ liệu đơn hàng từ các nền tảng thương mại điện tử.",
        "fields": [
        { "name": "_id", "type": "ObjectId", "autoGenerated": true, "tags": {"json": "_id", "bson": "_id"} },
        { "name": "order_id", "type": "string", "tags": {"json": "order_id", "bson": "order_id"} },
        { "name": "customer_id", "type": "string", "tags": {"json": "customer_id", "bson": "customer_id"} },
        { "name": "amount", "type": "decimal", "tags": {"json": "amount", "bson": "amount"} },
        { "name": "currency", "type": "string", "tags": {"json": "currency", "bson": "currency"} },
        { "name": "order_date", "type": "date", "tags": {"json": "order_date", "bson": "order_date"} },
        { "name": "location", "type": "geoPoint", "tags": {"json": "location", "bson": "location"} }
        ]
    }
    ],
    "api": {
    "basePath": "/api/v1",
    "endpoints": [
        {
        "name": "GetOrders",
        "method": "GET",
        "path": "/orders",
        "description": "Lấy danh sách đơn hàng.",
        "params": [
            { "name": "limit", "type": "integer", "required": false, "validation": {"min": 1, "max": 1000} },
            { "name": "page", "type": "integer", "required": false, "validation": {"min": 1} }
        ],
        "permissions": ["read:orders"],
        "dataTarget": {
            "database": "dwh_mongo",
            "collection": "orders"
        }
        },
        {
        "name": "CreateOrder",
        "method": "POST",
        "path": "/orders",
        "description": "Tạo mới một đơn hàng.",
        "body": {
            "type": "application/json",
            "schema": {
            "order_id": { "type": "string", "required": true, "validation": {"pattern": "^[A-Z0-9]{8,12}$"} },
            "customer_id": { "type": "string", "required": true },
            "amount": { "type": "decimal", "required": true, "validation": {"min": 0.01} },
            "currency": { "type": "string", "required": true, "validation": {"enum": ["USD", "EUR", "VND"]} },
            "order_date": { "type": "date", "required": true }
            }
        },
        "permissions": ["create:orders"],
        "dataTarget": {
            "database": "dwh_mongo",
            "collection": "orders"
        }
        }
    ]
    },
    "logging": {
    "logLevel": "INFO",
    "logRetentionDays": 90,
    "logTypes": [
        {
        "type": "API_Request",
        "description": "Ghi log các yêu cầu API bao gồm thông tin endpoint, phương thức, và thời gian thực thi."
        },
        {
        "type": "ETL_Process",
        "description": "Ghi log chi tiết về các pipeline ETL bao gồm thời gian bắt đầu, kết thúc, và trạng thái thành công hay thất bại."
        },
        {
        "type": "Database_Operation",
        "description": "Ghi log các thao tác trên cơ sở dữ liệu như insert, update, delete."
        },
        {
        "type": "Error_Log",
        "description": "Ghi lại các lỗi phát sinh trong quá trình xử lý dữ liệu hoặc gọi API."
        }
    ],
    "logFormat": "JSON",
    "logStorage": {
        "type": "database",
        "database": "log_db",
        "collection": "logs"
    }
    }
    
}
  